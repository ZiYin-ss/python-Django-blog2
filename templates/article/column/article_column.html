{% extends "article/base.html" %}
{% block title %}article column{% endblock %}
{% block content %}
<div>
    <p class="text-right"><button id="add_column" onclick="add_column()" class="btn btn-primary">add column</button></p>
    <table class="table table-hover">
    <tr>
        <td>序号</td>
        <td>栏目名称</td>
        <td>操作</td>
    </tr>
    {% for column in columns %}
    <tr>

        <td>{{ forloop.counter }}</td>
        <td>{{ column.column }}</td>
        <td>
            <a name="edit" href=" " onclick="edit_column(this, {{ column.id }})">
                <span class="glyphicon glyphicon-pencil"></span>
            </a>
            <a name="delete" href="javascript:" onclick="del_column(this, {{ column.id }})">
            <span class="glyphicon glyphicon-trash" style="margin-left:20px; "></span>
            </a>
        </td>
    </tr>
    {% empty %}
    <p>还没有设置栏目，太懒了。</p>
    {% endfor %}
    </table>
</div>


<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/layer/3.5.1/layer.js"></script>
<script type="text/javascript">
    function add_column(){
         layer.open({
            type:1,
            skin:"layui-layer-rim",
            area: ["400px", "200px"],
            title: "新增栏目",
            content: '<div class="text-center" style="margin-top:20px"> <p>请编辑目录的名称</p> <p>{{column_form.column}}</p> </div>',
            btn:['确定', '取消'],
            yes: function(index, layero){
                column_name = $('#id_column').val();  //这个是{{column_form.column}} 生成的一个id=id_column  自动生成 不知道的话 检查网页源代码
                $.ajax({
                    url:'{%url "article:article_column"%}',
                    type: 'POST',
                    data:{"column":column_name},
                    success(e){
                        if(e=="1"){
                            parent.location.reload()
                            layer.msg("good")
                        }else {
                            layer.msg("此栏目已有 请更换名称")
                        }
                    }
                })
            },
            btn2: function(index, layero){
                layer.close(index);
            }
        });
    }
</script>




{% endblock %}